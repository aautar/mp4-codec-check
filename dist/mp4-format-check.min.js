Mp4FormatCheck=function(){return this.checker=function(e){var t=this;this.filePointer=0,this.formatTypesFound=[],this.run=function(e){t.readNextFileSlice(e)},this.readNextFileSlice=function(r){var n=e.slice(t.filePointer,t.filePointer+8);t.filePointer+=8,n.size<8?r(t.formatTypesFound):t.readBlob(n,r)},this.readBlob=function(r,n){t.blobToArrayBuffer(r).then(function(r){var i=new DataView(r).getUint32(0,!1),o=t.readStringFromDataView(new DataView(r),4,4);if("stsd"===o){var a=e.slice(t.filePointer,t.filePointer+(i-8));t.readStsdAtom(a).then(function(){t.filePointer+=i-8,t.readNextFileSlice(n)})}else if("moov"===o||"trak"===o||"mdia"===o||"minf"===o||"stbl"===o)t.readNextFileSlice(n);else{if(1===i){var f=e.slice(t.filePointer,t.filePointer+8);t.filePointer+=8,t.blobToArrayBuffer(f).then(function(e){var r=t.stuffInt64BytesIntoNumber(e);t.filePointer+=r})}t.filePointer+=i-8,t.readNextFileSlice(n)}})},this.readStsdAtom=function(e){return new Promise(function(r){var n=new FileReader;n.onload=function(){for(var e=new DataView(n.result),i=(e.getUint8(0),e.getUint8(1),e.getUint8(2),e.getUint8(3),e.getUint32(4,!1)),o=8,a=0;i>a;a++){{var f=e.getUint32(o,!1),u=t.readStringFromDataView(e,o+4,4);t.readStringFromDataView(e,o+8,f-8),t.readStringFromDataView(e,o+f-8,8)}o+=f,t.formatTypesFound.push({type:u.toLowerCase()})}r()},n.readAsArrayBuffer(e)})},this.blobToArrayBuffer=function(e){return new Promise(function(t){var r=new FileReader;r.onload=function(){t(r.result)},r.readAsArrayBuffer(e)})},this.stuffInt64BytesIntoNumber=function(e){for(var t=new DataView(e),r=[],n=0;8>n;n++)r.push(t.getUint8(n));var i=r.map(function(e){return e.toString(2).padStart(8,"0")}),o=i.join("");return parseInt(o,2)},this.readStringFromDataView=function(e,t,r){for(var n="",i=0;r>i;i++)n+=String.fromCharCode(e.getInt8(t+i));return n}},{findFormats:function(e,t){var r=new checker(e);r.run(function(e){t(e)})},containsH264Format:function(e){for(var t=0;t<e.length;t++)if("h264"===e[t].type||"avc1"===e[t].type)return!0;return!1}}}(),"undefined"!=typeof module&&module.exports&&(module.exports=Mp4FormatCheck);